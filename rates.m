function dydt = rates(~,a)
%a is concentration of species and t is time
% b = d[CH4]/dt , a(1)=[CH4]
% c = d[CH3]/dt , a(2)=[CH3]
% d = d[H]/dt , a(3)=[H]
% e = d[H2]/dt , a(4)=[H2]
% f = d[(na)2]/dt , a(5)=[(na)2]
% g = d[(na)]/dt , a(6)=[(na)]
% h = d[(na)3]/dt , a(7)=[(na)3]
% i = d[(na)H]/dt , a(8)=[(na)H]
% j = d[(na)3H]/dt , a(9)=[(na)3H]
% k = d[(na)2H]/dt , a(10)=[(na)2H]
% l = d[H(na)CH3]/dt , a(11)=[H(na)CH3]
% m = d[H(na)2CH3]/dt , a(12)=[H(na)2CH3]
% n = d[H(na)3CH3]/dt , a(13)=[H(na)3CH3]
% o = d[C2H6]/dt , a(14)=[C2H6]
% p = d[(na)CH3]/dt , a(15)=[(na)CH3]
% q = d[(na)2CH3]/dt , a(16)=[(na)2CH3]
dydt = zeros(16,1);
p0=101325; %1 atm
na=6.023*10^17;
v0=0.001; %m^3
y1=0.45*p0*v0/(8.314*973); %mol P1V0/RT
y6=0.1*p0*v0/(8.314*973); %mol P6V0/RT
yar=y1; %mol ParV0/RT
n0=y1+y6+yar;

% nt=0;
% for i=1:16
%     nt=nt+a(i);
% end
% nt=nt+yar;
nt=a(1)+a(2)+a(3)+a(4)+a(5)+a(6)+a(7)+a(8)+a(9)+a(10)+a(11)+a(12)+a(13)+a(14)+a(15)+a(16);
v=nt*v0/n0;

kf=[1.1*10^-8, 2.2*10^9, 1.5*10^11, (na)*2.2*10^-21, (na)*3.2*10^-22, (na)*1*10^-23, (na)*9.4*10^-27, (na)*2.3*10^-23, (na)*3.1*10^-21, (na)*6.9*10^-13, (na)*9.9*10^-24, 9.5*10^9, 8.7*10^10, 6.8*10^3, 8.4*10^5, 7.1*10^3, 5*10^9, 5.8*10^8, 4.4*10^-1, 1.4*10^8, 2.4*10^1, 4.7*10^6, (na)*1.9*10^-10, (na)*2.8*10^-10];
kb=[(na)*4.1*10^-10, (na)*1.5*10^-9, (na)*4.4*10^-9, (na)*1.9*10^-10, 4.1*10^9, (na)*1.9*10^-12, (na)*6.6*10^-11, 3.9*10^2, 4.7*10^4, (na)*5.7*10^-15, (na)*3.8*10^-19, (na)*3.3*10^-9, (na)*7.3*10^-9, (na)*3*10^-9, (na)*2.3*10^-10, (na)*1.4*10^-9, (na)*1.5*10^-9, (na)*3.1*10^-9, (na)*3.7*10^-12, (na)*5.1*10^-10, (na)*5*10^-10, (na)*3.9*10^-11, 1.8*10^-10, 2.7*10^-4];

b=v*((-kf(1)*(a(1)/v)+kb(1)*(a(2)/v)*(a(3)/v))  +   (-kf(4)*(a(1)/v)*(a(6)/v)+kb(4)*(a(8)/v)*(a(2)/v))  +   (-kf(5)*(a(6)/v)*(a(1)/v)+kb(5)*(a(11)/v))  +   (-kf(6)*(a(1)/v)*(a(5)/v)+kb(6)*(a(10)/v)*(a(2)/v)) +   (-kf(7)*(a(1)/v)*(a(5)/v)+kb(7)*(a(16)/v)*(a(3)/v)) +   (-kf(8)*(a(1)/v)*(a(5)/v)+kb(8)*(a(12)/v))  +   (-kf(9)*(a(1)/v)*(a(7)/v)+kb(9)*(a(13)/v))  +   (-kf(10)*(a(1)/v)*(a(3)/v)+kb(10)*(a(2)/v)*(a(4)/v))    +   (-kf(11)*(a(1)/v)*(a(2)/v)+kb(11)*(a(14)/v)*(a(3)/v)));

c=v*((kf(1)*(a(1)/v)-kb(1)*(a(2)/v)*(a(3)/v))   +   (kf(4)*(a(1)/v)*(a(6)/v)-kb(4)*(a(8)/v)*(a(2)/v))   +   (kf(6)*(a(1)/v)*(a(5)/v)-kb(6)*(a(10)/v)*(a(2)/v)   +   (kf(10)*(a(1)/v)*(a(3)/v)-kb(10)*(a(2)/v)*(a(4)/v)) +   (-kf(11)*(a(1)/v)*(a(2)/v)+kb(11)*(a(14)/v)*(a(3)/v))   +   (kf(13)*(a(11)/v)-kb(13)*(a(8)/v)*(a(2)/v)) +   (kf(15)*(a(15)/v)-kb(15)*(a(6)/v)*(a(2)/v)) +   (kf(18)*(a(16)/v)-kb(18)*(a(5)/v)*(a(2)/v)) +   2*(-kf(24)*(a(2)/v)*(a(2)/v)+2*kb(24)*(a(14)/v))));

d=v*((kf(1)*(a(1)/v)-kb(1)*(a(2)/v)*(a(3)/v))   +   (kf(7)*(a(1)/v)*(a(5)/v)-kb(7)*(a(16)/v)*(a(3)/v))  +   (-kf(10)*(a(1)/v)*(a(3)/v)+kb(10)*(a(2)/v)*(a(4)/v))    +   (kf(11)*(a(1)/v)*(a(2)/v)-kb(11)*(a(14)/v)*(a(3)/v))    +   (kf(12)*(a(11)/v)-kb(12)*(a(15)/v)*(a(3)/v))    +   (kf(14)*(a(8)/v)-kb(14)*(a(3)/v)*(a(6)/v))  +   (kf(16)*(a(10)/v)-kb(16)*(a(5)/v)*(a(3)/v)) +   (kf(21)*(a(9)/v)-kb(21)*(a(7)/v)*(a(3)/v))  +   2*(-kf(23)*(a(3)/v)*(a(3)/v)+2*(kb(23)*(a(4)/v))));

e=v*((kf(10)*(a(1)/v)*(a(3)/v)-kb(10)*(a(2)/v)*(a(4)/v))    +   (kf(23)*(a(3)/v)*(a(3)/v)-kb(23)*(a(4)/v)));

f=v*((-kf(2)*(a(5)/v)+(2*kb(2)*(a(6)/v)*(a(6)/v)))    +   (kf(3)*(a(7)/v)-kb(3)*(a(5)/v)*(a(6)/v))    +   (-kf(6)*(a(1)/v)*(a(5)/v)+kb(6)*(a(10)/v)*(a(2)/v)) +   (-kf(7)*(a(1)/v)*(a(5)/v)+kb(7)*(a(16)/v)*(a(3)/v)) +   (-kf(8)*(a(1)/v)*(a(5)/v)+kb(8)*(a(12)/v))     +    (kf(16)*(a(10)/v)-kb(16)*(a(5)/v)*(a(3)/v)) +   (kf(18)*(a(16)/v)-kb(18)*(a(5)/v)*(a(2)/v)) +   (kf(20)*(a(9)/v)-kb(20)*(a(5)/v)*(a(8)/v)));

g=v*((2*(kf(2)*(a(5)/v)-2*kb(2)*(a(6)/v)*(a(6)/v))) +   (kf(3)*(a(7)/v)-kb(3)*(a(5)/v)*(a(6)/v))    +   (-kf(4)*(a(1)/v)*(a(6)/v)+kb(4)*(a(8)/v)*(a(2)/v))  +   (-kf(5)*(a(6)/v)*(a(1)/v)+kb(5)*(a(11)/v))  +   (kf(14)*(a(8)/v)-kb(14)*(a(3)/v)*(a(6)/v))  +   (kf(15)*(a(15)/v)-kb(15)*(a(6)/v)*(a(2)/v)) +   (kf(17)*(a(10)/v)-kb(17)*(a(6)/v)*(a(8)/v)) +   (kf(19)*(a(16)/v)-kb(19)*(a(6)/v)*(a(15)/v))    +   (kf(22)*(a(9)/v)-kb(22)*(a(10)/v)*(a(6)/v)));

h=v*((-kf(3)*(a(7)/v)+kb(3)*(a(5)/v)*(a(6)/v))  +   (-kf(9)*(a(1)/v)*(a(7)/v)+kb(9)*(a(13)/v))  +   (kf(21)*(a(9)/v)-kb(21)*(a(7)/v)*(a(3)/v)));

i=v*((kf(4)*(a(1)/v)*(a(6)/v)-kb(4)*(a(8)/v)*(a(2)/v))  +   (kf(13)*(a(11)/v)-kb(13)*(a(8)/v)*(a(2)/v)) +   (-kf(14)*(a(8)/v)+kb(14)*(a(3)/v)*(a(6)/v)) +   (kf(17)*(a(10)/v)-kb(17)*(a(6)/v)*(a(8)/v)) +   (kf(20)*(a(9)/v)-kb(20)*(a(5)/v)*(a(8)/v)));

j=v*((-kf(20)*(a(9)/v)+kb(20)*(a(5)/v)*(a(8)/v))    +   (-kf(21)*(a(9)/v)+kb(21)*(a(7)/v)*(a(3)/v)) +   (-kf(22)*(a(9)/v)+kb(22)*(a(10)/v)*(a(6)/v)));

k=v*((kf(6)*(a(1)/v)*(a(5)/v)-kb(6)*(a(10)/v)*(a(2)/v)) +   (-kf(16)*(a(10)/v)+kb(16)*(a(5)/v)*(a(3)/v))    +   (-kf(17)*(a(10)/v)+kb(17)*(a(6)/v)*(a(8)/v))    +   (kf(22)*(a(9)/v)-kb(22)*(a(10)/v)*(a(6)/v)));

l=v*((kf(5)*(a(6)/v)*(a(1)/v)-kb(5)*(a(11)/v))  +   (-kf(12)*(a(11)/v)+kb(12)*(a(15)/v)*(a(3)/v))   +   (-kf(13)*(a(11)/v)+kb(13)*(a(8)/v)*(a(2)/v)));

m=v*(kf(8)*(a(1)/v)*(a(5)/v)-kb(8)*(a(12)/v));

n=v*(kf(9)*(a(1)/v)*(a(7)/v)-kb(9)*(a(13)/v));

o=v*((kf(11)*(a(1)/v)*(a(2)/v)-kb(11)*(a(14)/v)*(a(3)/v))   +   (kf(24)*(a(2)/v)*(a(2)/v)-2*kb(24)*(a(14)/v)));

p=v*((kf(12)*(a(11)/v)-kb(12)*(a(15)/v)*(a(3)/v))   +   (-kf(15)*(a(15)/v)+kb(15)*(a(6)/v)*(a(2)/v))    +   (kf(19)*(a(16)/v)-kb(19)*(a(6)/v)*(a(15)/v)));

q=v*((kf(7)*(a(1)/v)*(a(5)/v)-kb(7)*(a(16)/v)*(a(3)/v)) +   (-kf(18)*(a(16)/v)+kb(18)*(a(5)/v)*(a(2)/v))    +   (-kf(19)*(a(16)/v)+kb(19)*(a(6)/v)*(a(15)/v)));


kfn = 1.02 * kf; % Changed (increased) by 2%
keq = kf ./ kb;
kbn = kfn ./ keq;

x1 = (-kfn(1) * a(1) / b) + (kbn(1) * a(2) * (a(3) / v) / b);
x2 = 0;
x3 = 0;
x4 = (-kfn(4) * a(1) * (a(6) / v) / b) + (kbn(4) * a(8) * (a(2) / v) / b);
x5 = (-kfn(5) * a(6) * (a(1) / v) / b) + (kbn(5) * a(11) / b);
x6 = (-kfn(6) * a(1) * (a(5) / v) / b) + (kbn(6) * a(10) * (a(2) / v) / b);
x7 = (-kfn(7) * (a(1) * a(5) / v) / b) + (kbn(7) * a(16) * (a(3) / v) / b);
x8 = (-kfn(8) * (a(1) * a(5) / v) / b) + (kbn(8) * a(12) / b);
x9 = (-kfn(9) * (a(1) * a(7) / v) / b) + (kbn(9) * a(13) / b);
x10 = (-kfn(10) * (a(1) * a(3) / v) / b) + (kbn(10) * a(2) * (a(4) / v) / b);
x11 = (-kfn(11) * (a(1) * a(2) / v) / b) + (kbn(11) * a(14) * (a(3) / v) / b);

% Degree of rate control
x = [x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];


dydt=[b;c;d;e;f;g;h;i;j;k;l;m;n;o;p;q];

end